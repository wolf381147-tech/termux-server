# 安全指南

## 概述

本项目遵循严格的安全规范，确保在Android设备上运行服务器服务时的安全性。以下是项目中实施的主要安全措施和最佳实践。

## 目录和文件安全

### 避免硬编码敏感信息

项目中所有路径和敏感配置都已从代码中移除，改为通过环境变量或配置文件管理：

- Web服务器目录：使用 `WEBSITE_DIR` 环境变量配置
- 日志目录：使用 `LOGS_DIR` 环境变量配置
- 临时文件目录：使用 `TEMP_DIR` 环境变量配置
- PID文件目录：使用 `PID_DIR` 环境变量配置

### 配置文件管理

配置文件位于 `termux-server-suite/config/` 目录中，包含以下安全措施：

1. **敏感信息保护**：配置文件中不包含任何密码或密钥
2. **权限控制**：配置文件具有适当的文件权限
3. **环境变量支持**：支持通过环境变量覆盖默认配置

## 命令执行安全

为了防止命令注入攻击，所有模块都实现了命令安全检查机制。

### 服务管理器安全检查

- 限制可执行的命令类型
- 禁止危险命令如 `rm -rf`、`format` 等
- 对所有执行的命令进行安全验证

### 唤醒锁管理器安全检查

- 仅允许预定义的Termux安全命令
- 包括 `termux-wake-lock`、`termux-wake-unlock`、`termux-battery-status`

### 服务监控器安全检查

- 仅允许安全的服务管理命令
- 包括 `sshd`、`python3 -m http.server` 等

## 网络安全

### 端口管理

项目使用以下端口：

1. **SSH服务**：默认端口 8022
2. **Web服务**：默认端口 8000

### 防火墙建议

建议在公网环境下运行时采取以下措施：

1. 使用防火墙限制对特定IP地址的访问
2. 定期更新系统和软件包
3. 使用强密码和密钥认证

## 数据保护

### 日志安全

- 日志文件不包含敏感信息
- 日志文件定期轮转以避免占用过多存储空间
- 日志文件存储在安全的位置

### 备份安全

备份工具不包含任何敏感信息，仅备份系统状态和已安装包列表。

## 最佳实践

### 权限管理

1. 仅授予必要的权限
2. 定期审查权限设置
3. 使用最小权限原则

### 更新管理

1. 定期更新Termux和相关包
2. 关注安全公告
3. 及时应用安全补丁

### 监控和审计

1. 启用日志记录
2. 定期检查日志
3. 监控异常活动

## 故障排除

### 常见安全问题

1. **端口冲突**：确保端口未被其他应用占用
2. **权限问题**：检查文件和目录权限
3. **网络连接**：验证网络配置和防火墙设置

### 安全检查清单

- [ ] 检查配置文件中的敏感信息
- [ ] 验证命令执行安全性
- [ ] 确认网络端口配置
- [ ] 检查文件权限设置
- [ ] 验证日志记录配置